package com.certoclav.certoscale.database;


import com.j256.ormlite.field.DataType;
import com.j256.ormlite.field.DatabaseField;
import com.j256.ormlite.table.DatabaseTable;

import org.json.JSONObject;


@DatabaseTable(tableName = "protocol")
public class Protocol {


	private static final String JSON_CONTENT_STRING = "content";
	private final static String JSON_CONTENT_JSON = "content_json";
	private final static String JSON_DEVICE_KEY = "devicekey";
	private final static String JSON_DATE = "date";
	private final static String JSON_VISIBILITY = "visibility";
	private final static String JSON_NAME = "name";
	private final static String JSON_CLOUD_ID = "_id"; //user db id from MongoDb
	private final static String JSON_USER_EMAIL = "email";
	private final static String JSON_SIGNATURE ="signature";

	//additional for ash_determinatin_ticket_system
	private final static String JSON_ASH_SAMPLE_NAME = "ash_name_sample";
	private final static String JSON_ASH_BEAKER_NAME = "ash_name_beaker";
	private final static String JSON_ASH_ARRAY_GLOW_WEIGHTS = "ash_array_glow_weights";
	private final static String JSON_ASH_RESULT_PERCENTAGE = "ash_result_percentage";
	private final static String JSON_ASH_RESULT_GRAM = "ash_result_gram";
	private final static String JSON_ASH_WEIGHT_BEAKER = "ash_weight_beaker";
	private final static String JSON_ASH_WEIGHT_BEAKER_WITH_SAMPLE = "ash_weight_beaker_with_sample";
	private final static String JSON_IS_PENDING = "ispending";





	private String name = "";
	private String userEmail = "";
	private String deviceKey = "";
	private String visibility = "global";
	private String content = "";
	private String date = "";
	private String cloudId = "";
	private String contentJson = "";


	public String getAshSampleName() {
		return ashSampleName;
	}

	public void setAshSampleName(String ashSampleName) {
		this.ashSampleName = ashSampleName;
	}

	public String getAshBeakerName() {
		return ashBeakerName;
	}

	public void setAshBeakerName(String ashBeakerName) {
		this.ashBeakerName = ashBeakerName;
	}

	public String getAshArrayGlowWeights() {
		return ashArrayGlowWeights;
	}

	public void setAshArrayGlowWeights(String ashArrayGlowWeights) {
		this.ashArrayGlowWeights = ashArrayGlowWeights;
	}

	public String getAshResultPercentage() {
		return ashResultPercentage;
	}

	public void setAshResultPercentage(String ashResultPercentage) {
		this.ashResultPercentage = ashResultPercentage;
	}

	public String getAshResultGram() {
		return ashResultGram;
	}

	public void setAshResultGram(String ashResultGram) {
		this.ashResultGram = ashResultGram;
	}

	public String getAshWeightBeaker() {
		return ashWeightBeaker;
	}

	public void setAshWeightBeaker(String ashWeightBeaker) {
		this.ashWeightBeaker = ashWeightBeaker;
	}

	public String getAshWeightBeakerWithSample() {
		return ashWeightBeakerWithSample;
	}

	public void setAshWeightBeakerWithSample(String ashWeightBeakerWithSample) {
		this.ashWeightBeakerWithSample = ashWeightBeakerWithSample;
	}

	private String ashSampleName = "";
	private String ashBeakerName = "";
	private String ashArrayGlowWeights = "";
	private String ashResultPercentage = "";
	private String ashResultGram = "";
	private String ashWeightBeaker = "";
	private String ashWeightBeakerWithSample = "";

    public String getIsPending() {
        return isPending;
    }

    public void setIsPending(String isPending) {
        this.isPending = isPending;
    }

    private String isPending = "";


	@DatabaseField(columnName = JSON_SIGNATURE,dataType = DataType.STRING_BYTES)
	private String signature;



	public String getProtocolJson() {
		generateJson();
		return protocolJson;
	}


	@DatabaseField(generatedId = true, columnName = "protocol_id")
	private int item_id;

	@DatabaseField(columnName = "protocol_json")
	private String protocolJson;



	public String getDate() {
		return this.date;
	}

	public void setDate(String date) {
		this.date = date;
	}


	// id is generated by the database and set on the object automatically


	Protocol() {

	}

	public Protocol( String protocolJson) {
		setProtocolJson(protocolJson);
		this.protocolJson = protocolJson;
	}


	public void setProtocolJson(String itemJson) {
		this.protocolJson = itemJson;
		parseJson();
	}

	public void parseJson(){

		JSONObject jsonObject = null;
		try {
			jsonObject = new JSONObject(protocolJson);
		}catch (Exception e){
			return;
		}

		try {
			name = jsonObject.getString(JSON_NAME);
		}catch (Exception e){
			name = "";
		}
		try {
			userEmail = jsonObject.getString(JSON_USER_EMAIL);
		}catch (Exception e){
			userEmail = "";
		}

		try {
			visibility = jsonObject.getString(JSON_VISIBILITY);
		}catch (Exception e){
			visibility = "private";
		}



		try {
			date = jsonObject.getString(JSON_DATE);
		}catch (Exception e){
			date = "";
		}


		try {
			deviceKey = jsonObject.getString(JSON_DEVICE_KEY);
		}catch (Exception e){
			deviceKey = "";
		}


		try {
			cloudId = jsonObject.getString(JSON_CLOUD_ID);
		}catch (Exception e){
			cloudId = "";
		}

		try {
			content = jsonObject.getString(JSON_CONTENT_STRING);
		}catch (Exception e){
			content = "";
		}
		try {
			signature=jsonObject.getString(JSON_SIGNATURE);

		}catch (Exception e){
			signature = "";
		}

		try {
			content = jsonObject.getString(JSON_CONTENT_STRING);
		}catch (Exception e){
			content = "";
		}


		try {
			ashSampleName = jsonObject.getString(JSON_ASH_SAMPLE_NAME);
		}catch (Exception e){
			ashSampleName = "";
		}

		try {
			ashBeakerName = jsonObject.getString(JSON_ASH_BEAKER_NAME);
		}catch (Exception e){
			ashBeakerName = "";
		}

		try {
			ashArrayGlowWeights = jsonObject.getString(JSON_ASH_ARRAY_GLOW_WEIGHTS);
		}catch (Exception e){
			ashArrayGlowWeights = "";
		}

		try {
			ashResultPercentage = jsonObject.getString(JSON_ASH_RESULT_PERCENTAGE);
		}catch (Exception e){
			ashResultPercentage = "";
		}

		try {
			ashResultGram = jsonObject.getString(JSON_ASH_RESULT_GRAM);
		}catch (Exception e){
			ashResultGram = "";
		}

		try {
			ashWeightBeaker = jsonObject.getString(JSON_ASH_WEIGHT_BEAKER);
		}catch (Exception e){
			ashWeightBeaker = "";
		}

		try {
			ashWeightBeakerWithSample = jsonObject.getString(JSON_ASH_WEIGHT_BEAKER_WITH_SAMPLE);
		}catch (Exception e){
			ashWeightBeakerWithSample = "";
		}

        try {
            isPending = jsonObject.getString(JSON_IS_PENDING);
        }catch (Exception e){
            isPending = "";
        }



		protocolJson = jsonObject.toString();

	}







	public Protocol(String cloudId, String protocolJson) {
		this.cloudId = cloudId;
		this.protocolJson = protocolJson;
	}

	public Protocol(String cloudId, String name, String userEmail, String deviceKey, String date, String visibility, String content,String signature) {
		this.cloudId = cloudId;
		this.name = name;
		this.userEmail = userEmail;
		this.deviceKey = deviceKey;
		this.date = date;
		this.visibility = visibility;
		this.content = content;
		this.signature = signature;
	}




	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public String getUserEmail() {
		return userEmail;
	}

	public void setUserEmail(String userEmail) {
		this.userEmail = userEmail;
	}

	public String getDeviceKey() {
		return deviceKey;
	}

	public void setDeviceKey(String deviceKey) {
		this.deviceKey = deviceKey;
	}

	public String getVisibility() {
		return visibility;
	}

	public void setVisibility(String visibility) {
		this.visibility = visibility;
	}

	public String getContent() {
		return content;
	}

	public void setContent(String content) {
		this.content = content;
	}

	public void setItem_id(int item_id) {
		this.item_id = item_id;
	}

	public String getCloudId() {
		return cloudId;
	}

	public void setCloudId(String cloudId) {
		this.cloudId = cloudId;
	}

	public String getSignature() {return signature;}

	//public void setSignature(String signature) {this.signature = signature;}





	public void generateJson(){
		JSONObject jsonObject = new JSONObject();

		try {
			jsonObject.put(JSON_CLOUD_ID,cloudId)
					.put(JSON_NAME, name)
					.put(JSON_DEVICE_KEY,deviceKey)
					.put(JSON_DATE,date)
					.put(JSON_USER_EMAIL, userEmail)
					.put(JSON_VISIBILITY,visibility)
					.put(JSON_CONTENT_STRING,content)
					.put(JSON_SIGNATURE,signature)
					.put(JSON_ASH_SAMPLE_NAME,ashSampleName)
					.put(JSON_ASH_BEAKER_NAME,ashBeakerName)
					.put(JSON_ASH_ARRAY_GLOW_WEIGHTS,ashArrayGlowWeights)
					.put(JSON_ASH_RESULT_PERCENTAGE,ashResultPercentage)
					.put(JSON_ASH_RESULT_GRAM,ashResultGram)
					.put(JSON_ASH_WEIGHT_BEAKER,ashWeightBeaker)
					.put(JSON_ASH_WEIGHT_BEAKER_WITH_SAMPLE,ashWeightBeakerWithSample)
			        .put(JSON_IS_PENDING,isPending);

		}catch (Exception e){
			e.printStackTrace();
		}
		protocolJson = jsonObject.toString();
	}


}



